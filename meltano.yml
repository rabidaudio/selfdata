version: 1
default_environment: local
send_anonymous_usage_stats: true
project_id: 7719d6c0-e1ea-45f2-85e4-a647da2211dd
plugins:
  extractors:
  - name: tap-lastfm
    namespace: tap_lastfm
    pip_url: git+https://github.com/rabidaudio/tap-lastfm.git@v0.1.0
    executable: tap-lastfm
    capabilities:
    - catalog
    - discover
    - state
    settings:
    - name: api_key
      kind: password
    - name: usernames
      kind: array
    - name: user_agent
      kind: string
    - name: start_date
      kind: date_iso8601
    config:
      api_key: $TAP_LASTFM_API_KEY
      usernames:
      - rabidaudio
      - kath_ebooks
      - valwigg
      - UntiLiUnderstan
      - trackstarlol
      - schwegler
      - emorphis
    select:
    - '*.*'
    - '!*.*image*'
  utilities:
  - name: dagster
    namespace: dagster
    pip_url: -e orchestrate
    executable: dagster
    settings:
    - name: home
      env: DAGSTER_HOME
    - name: schedule_timezone
      env: DAGSTER_SCHEDULE_TIMEZONE
    - name: database_url
      env: DAGSTERDB_URL
    commands:
      scheduler:
        args: run -w $DAGSTER_HOME/workspace.yaml
        executable: dagster-daemon
      ui:
        args: -w $DAGSTER_HOME/workspace.yaml -h 0.0.0.0
        executable: dagit
      test:
        args: ''
        executable: pytest
    config:
      schedule_timezone: America/New_York
      database_url: $DAGSTERDB_URL
      home: $MELTANO_PROJECT_ROOT/orchestrate
schedules:
- name: scrobbles
  extractor: tap-lastfm
  loader: target-postgres
  transform: skip
  interval: '@daily'
  start_date: 2021-11-17 07:15:23.937016
environments:
- name: local
  config:
    plugins:
      loaders:
      - name: target-postgres
        config:
          postgres_database: selfdata
        variant: datamill-co
        pip_url: singer-target-postgres
  env:
    DAGSTERDB_URL: postgresql://localhost:5432/dagster
    MELTANO_UI_WORKERS: '1'
